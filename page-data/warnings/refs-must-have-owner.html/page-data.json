{"componentChunkName":"component---src-templates-docs-js","path":"/warnings/refs-must-have-owner.html","result":{"data":{"markdownRemark":{"html":"<p>Вероятно, вы зашли на эту страницу потому что получили одно из следующих сообщений об ошибке:</p>\n<p><em>React 16.0.0+</em></p>\n<blockquote>\n<p>Warning:</p>\n<p>Element ref was specified as a string (myRefName) but no owner was set. You may have multiple copies of React loaded. (details: <a href=\"https://fb.me/react-refs-must-have-owner\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://fb.me/react-refs-must-have-owner</a>).</p>\n</blockquote>\n<p><em>более ранние версии React</em></p>\n<blockquote>\n<p>Warning:</p>\n<p>addComponentAsRefTo(…): Only a ReactOwner can have refs. You might be adding a ref to a component that was not created inside a component’s <code class=\"gatsby-code-text\">render</code> method, or you have multiple copies of React loaded.</p>\n</blockquote>\n<p>Обычно это означает одно из трёх:</p>\n<ul>\n<li>Вы пытаетесь добавить <code class=\"gatsby-code-text\">ref</code> в функциональный компонент.</li>\n<li>Вы пытаетесь добавить <code class=\"gatsby-code-text\">ref</code> к элементу, который был создан вне метода <code class=\"gatsby-code-text\">render()</code> текущего компонента.</li>\n<li>У вас загружено несколько конфликтующих копий React (например, из-за неправильной настройки npm-зависимостей).</li>\n</ul>\n<h2 id=\"refs-on-function-components\"><a href=\"#refs-on-function-components\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Рефы и функциональные компоненты </h2>\n<p>Если <code class=\"gatsby-code-text\">&lt;Foo></code> — функциональный компонент, ему нельзя добавить <code class=\"gatsby-code-text\">ref</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token comment\">// Не работает, если Foo это функция!</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>foo<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>Если требуется добавить <code class=\"gatsby-code-text\">ref</code> к компоненту, преобразуйте его в класс или не пользуйтесь механизмом рефов, потому что он <a href=\"/docs/refs-and-the-dom.html#when-to-use-refs\">редко необходим</a>. </p>\n<h2 id=\"strings-refs-outside-the-render-method\"><a href=\"#strings-refs-outside-the-render-method\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Строковые рефы вне метода <code class=\"gatsby-code-text\">render</code> </h2>\n<p>Обычно это означает, что вы пытаетесь добавить реф к компоненту, который не имеет владельца (т.е. не был создан внутри метода <code class=\"gatsby-code-text\">render</code> какого-либо компонента).</p>\n<p>Следующий пример не будет работать:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token comment\">// Не работает!</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">ref</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Попробуйте отрендерить этот компонент внутри нового компонента-обёртки, который будет содержать реф. Как вариант, вы можете использовать колбэк-реф:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">let</span> app<span class=\"token punctuation\">;</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">inst</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    app <span class=\"token operator\">=</span> inst<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  el\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Хорошо подумайте, <a href=\"/docs/refs-and-the-dom.html#when-to-use-refs\">действительно ли вам нужен реф</a> перед использованием этого подхода.</p>\n<h2 id=\"multiple-copies-of-react\"><a href=\"#multiple-copies-of-react\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Несколько копий React </h2>\n<p>Bower хорошо решает вопрос дублирования зависимостей, а вот npm — нет. Если вы не делаете с вашими рефами ничего особенного, скорее всего, проблема не в вашем коде, а в нескольких загруженных копиях React. Иногда, когда вы устанавливаете сторонний пакет через npm, вы можете получить дублирование библиотеки из зависимостей, и это может создать проблему.</p>\n<p>Если вы используете npm, <code class=\"gatsby-code-text\">npm ls</code> или <code class=\"gatsby-code-text\">npm ls react</code> поможет разобраться, какие установлены зависимости.</p>","frontmatter":{"title":"Предупреждение: У рефа должен быть владелец","next":null,"prev":null},"fields":{"path":"content\\warnings\\refs-must-have-owner.md","slug":"warnings/refs-must-have-owner.html"}}},"pageContext":{"slug":"warnings/refs-must-have-owner.html"}},"staticQueryHashes":[]}